import{a as O,o as N,r as re,e as v,g as oe,f as _,h as U,i as se,u as M,j as ae,k as D,s as ce,l as ie,m as ue,d as b,n as le,b as fe,S as H}from"../solid-js-b9f6b6bd.js";function he(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function de([e,t],n,o){return[n?()=>n(e()):e,o?r=>t(o(r)):t]}function pe(e){try{return document.querySelector(e)}catch{return null}}function ge(e,t){const n=pe(`#${e}`);n?n.scrollIntoView():t&&window.scrollTo(0,0)}function me(e,t,n,o){let r=!1;const s=c=>typeof c=="string"?{value:c}:c,a=de(O(s(e()),{equals:(c,u)=>c.value===u.value}),void 0,c=>(!r&&t(c),c));return n&&N(n((c=e())=>{r=!0,a[1](s(c)),r=!1})),{signal:a,utils:o}}function we(e){if(e){if(Array.isArray(e))return{signal:e}}else return{signal:O({value:""})};return e}function ye(){return me(()=>({value:window.location.pathname+window.location.search+window.location.hash,state:history.state}),({value:e,replace:t,scroll:n,state:o})=>{t?window.history.replaceState(o,"",e):window.history.pushState(o,"",e),ge(window.location.hash.slice(1),n)},e=>he(window,"popstate",()=>e()),{go:e=>window.history.go(e)})}function ve(){let e=new Set;function t(r){return e.add(r),()=>e.delete(r)}let n=!1;function o(r,s){if(n)return!(n=!1);const a={to:r,options:s,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const c of e)c.listener({...a,from:c.location,retry:u=>{u&&(n=!0),c.navigate(r,s)}});return!a.defaultPrevented}return{subscribe:t,confirm:o}}const Re=/^(?:[a-z0-9]+:)?\/\//i,Pe=/^\/+|(\/)\/+$/g;function k(e,t=!1){const n=e.replace(Pe,"$1");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function T(e,t,n){if(Re.test(t))return;const o=k(e),r=n&&k(n);let s="";return!r||t.startsWith("/")?s=o:r.toLowerCase().indexOf(o.toLowerCase())!==0?s=o+r:s=r,(s||"/")+k(t,!s)}function be(e,t){if(e==null)throw new Error(t);return e}function J(e,t){return k(e).replace(/\/*(\*.*)?$/g,"")+k(t)}function Ae(e){const t={};return e.searchParams.forEach((n,o)=>{t[o]=n}),t}function Se(e,t,n){const[o,r]=e.split("/*",2),s=o.split("/").filter(Boolean),a=s.length;return c=>{const u=c.split("/").filter(Boolean),p=u.length-a;if(p<0||p>0&&r===void 0&&!t)return null;const i={path:a?"":"/",params:{}},g=l=>n===void 0?void 0:n[l];for(let l=0;l<a;l++){const w=s[l],y=u[l],h=w[0]===":",A=h?w.slice(1):w;if(h&&F(y,g(A)))i.params[A]=y;else if(h||!F(y,w))return null;i.path+=`/${y}`}if(r){const l=p?u.slice(-p).join("/"):"";if(F(l,g(r)))i.params[r]=l;else return null}return i}}function F(e,t){const n=o=>o.localeCompare(e,void 0,{sensitivity:"base"})===0;return t===void 0?!0:typeof t=="string"?n(t):typeof t=="function"?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp?t.test(e):!1}function Ee(e){const[t,n]=e.pattern.split("/*",2),o=t.split("/").filter(Boolean);return o.reduce((r,s)=>r+(s.startsWith(":")?2:3),o.length-(n===void 0?0:1))}function X(e){const t=new Map,n=oe();return new Proxy({},{get(o,r){return t.has(r)||re(n,()=>t.set(r,v(()=>e()[r]))),t.get(r)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function G(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),o=e.slice(t.index+t[0].length);const r=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(o);)r.push(n+=t[1]),o=o.slice(t[0].length);return G(o).reduce((s,a)=>[...s,...r.map(c=>c+a)],[])}const xe=100,Q=_(),K=_(),V=()=>be(U(Q),"Make sure your app is wrapped in a <Router />");let j;const Y=()=>j||U(K)||V().base;function Ce(e,t="",n){const{component:o,data:r,children:s}=e,a=!s||Array.isArray(s)&&!s.length,c={key:e,element:o?()=>b(o,{}):()=>{const{element:u}=e;return u===void 0&&n?b(n,{}):u},preload:e.component?o.preload:e.preload,data:r};return Z(e.path).reduce((u,p)=>{for(const i of G(p)){const g=J(t,i),l=a?g:g.split("/*",1)[0];u.push({...c,originalPath:i,pattern:l,matcher:Se(l,!a,e.matchFilters)})}return u},[])}function Le(e,t=0){return{routes:e,score:Ee(e[e.length-1])*1e4-t,matcher(n){const o=[];for(let r=e.length-1;r>=0;r--){const s=e[r],a=s.matcher(n);if(!a)return null;o.unshift({...a,route:s})}return o}}}function Z(e){return Array.isArray(e)?e:[e]}function ee(e,t="",n,o=[],r=[]){const s=Z(e);for(let a=0,c=s.length;a<c;a++){const u=s[a];if(u&&typeof u=="object"&&u.hasOwnProperty("path")){const p=Ce(u,t,n);for(const i of p){o.push(i);const g=Array.isArray(u.children)&&u.children.length===0;if(u.children&&!g)ee(u.children,i.pattern,n,o,r);else{const l=Le([...o],r.length);r.push(l)}o.pop()}}}return o.length?r:r.sort((a,c)=>c.score-a.score)}function Oe(e,t){for(let n=0,o=e.length;n<o;n++){const r=e[n].matcher(t);if(r)return r}return[]}function ke(e,t){const n=new URL("http://sar"),o=v(u=>{const p=e();try{return new URL(p,n)}catch{return console.error(`Invalid path ${p}`),u}},n,{equals:(u,p)=>u.href===p.href}),r=v(()=>o().pathname),s=v(()=>o().search,!0),a=v(()=>o().hash),c=v(()=>"");return{get pathname(){return r()},get search(){return s()},get hash(){return a()},get state(){return t()},get key(){return c()},query:X(D(s,()=>Ae(o())))}}function je(e,t="",n,o){const{signal:[r,s],utils:a={}}=we(e),c=a.parsePath||(d=>d),u=a.renderPath||(d=>d),p=a.beforeLeave||ve(),i=T("",t),g=void 0;if(i===void 0)throw new Error(`${i} is not a valid base path`);i&&!r().value&&s({value:i,replace:!0,scroll:!1});const[l,w]=O(!1),y=async d=>{w(!0);try{await ce(d)}finally{w(!1)}},[h,A]=O(r().value),[S,$]=O(r().state),q=ke(h,S),x=[],E={pattern:i,params:{},path:()=>i,outlet:()=>null,resolvePath(d){return T(i,d)}};if(n)try{j=E,E.data=n({data:void 0,params:{},location:q,navigate:z(E)})}finally{j=void 0}function W(d,f,m){M(()=>{if(typeof f=="number"){f&&(a.go?p.confirm(f,m)&&a.go(f):console.warn("Router integration does not support relative routing"));return}const{replace:B,resolve:I,scroll:R,state:C}={replace:!1,resolve:!0,scroll:!0,...m},P=I?d.resolvePath(f):T("",f);if(P===void 0)throw new Error(`Path '${f}' is not a routable path`);if(x.length>=xe)throw new Error("Too many redirects");const L=h();if((P!==L||C!==S())&&!ie){if(p.confirm(P,m)){const ne=x.push({value:L,replace:B,scroll:R,state:S()});y(()=>{A(P),$(C),ue()}).then(()=>{x.length===ne&&te({value:P,state:C})})}}})}function z(d){return d=d||U(K)||E,(f,m)=>W(d,f,m)}function te(d){const f=x[0];f&&((d.value!==f.value||d.state!==f.state)&&s({...d,replace:f.replace,scroll:f.scroll}),x.length=0)}se(()=>{const{value:d,state:f}=r();M(()=>{d!==h()&&y(()=>{A(d),$(f)})})});{let d=function(f){if(f.defaultPrevented||f.button!==0||f.metaKey||f.altKey||f.ctrlKey||f.shiftKey)return;const m=f.composedPath().find(L=>L instanceof Node&&L.nodeName.toUpperCase()==="A");if(!m||!m.hasAttribute("link"))return;const B=m.href;if(m.target||!B&&!m.hasAttribute("state"))return;const I=(m.getAttribute("rel")||"").split(/\s+/);if(m.hasAttribute("download")||I&&I.includes("external"))return;const R=new URL(B);if(R.origin!==window.location.origin||i&&R.pathname&&!R.pathname.toLowerCase().startsWith(i.toLowerCase()))return;const C=c(R.pathname+R.search+R.hash),P=m.getAttribute("state");f.preventDefault(),W(E,C,{resolve:!1,replace:m.hasAttribute("replace"),scroll:!m.hasAttribute("noscroll"),state:P&&JSON.parse(P)})};ae(["click"]),document.addEventListener("click",d),N(()=>document.removeEventListener("click",d))}return{base:E,out:g,location:q,isRouting:l,renderPath:u,parsePath:c,navigatorFactory:z,beforeLeave:p}}function $e(e,t,n,o,r){const{base:s,location:a,navigatorFactory:c}=e,{pattern:u,element:p,preload:i,data:g}=o().route,l=v(()=>o().path);i&&i();const w={parent:t,pattern:u,get child(){return n()},path:l,params:r,data:t.data,outlet:p,resolvePath(y){return T(s.path(),y,l())}};if(g)try{j=w,w.data=g({data:t.data,params:r,location:a,navigate:c(w)})}finally{j=void 0}return w}const Te=e=>{const{source:t,url:n,base:o,data:r,out:s}=e,a=t||ye(),c=je(a,o,r);return b(Q.Provider,{value:c,get children(){return e.children}})},qe=e=>{const t=V(),n=Y(),o=le(()=>e.children),r=v(()=>ee(o(),J(n.pattern,e.base||""),Be)),s=v(()=>Oe(r(),t.location.pathname)),a=X(()=>{const i=s(),g={};for(let l=0;l<i.length;l++)Object.assign(g,i[l].params);return g});t.out&&t.out.matches.push(s().map(({route:i,path:g,params:l})=>({originalPath:i.originalPath,pattern:i.pattern,path:g,params:l})));const c=[];let u;const p=v(D(s,(i,g,l)=>{let w=g&&i.length===g.length;const y=[];for(let h=0,A=i.length;h<A;h++){const S=g&&g[h],$=i[h];l&&S&&$.route.key===S.route.key?y[h]=l[h]:(w=!1,c[h]&&c[h](),fe(q=>{c[h]=q,y[h]=$e(t,y[h-1]||n,()=>p()[h+1],()=>s()[h],a)}))}return c.splice(i.length).forEach(h=>h()),l&&w?l:(u=y[0],y)}));return b(H,{get when(){return p()&&u},keyed:!0,children:i=>b(K.Provider,{value:i,get children(){return i.outlet()}})})},Ke=(e,t)=>()=>b(qe,{base:t,children:e}),Be=()=>{const e=Y();return b(H,{get when(){return e.child},keyed:!0,children:t=>b(K.Provider,{value:t,get children(){return t.outlet()}})})};export{Te as R,Ke as u};
