import{c as Xe,u as Me,a as Ye,b as st,o as Ce}from"../solid-js-b9f6b6bd.js";import{_ as He,a as L,c as Ze,b as We,d as K,e as X,s as ke,f as ue,g as Ve,h as Re,i as ye,j as qe,k as Fe,l as Ke,m as $,n as xe,o as Le,p as it,q as Ne,r as Be,t as ze,u as Pe,v as Ge,w as Ue,x as Te,y as et,z as at,A as Je,B as ot}from"./common-716393bb.js";function ut(e,...t){const s=e.subscribe(...t);return s.unsubscribe?()=>s.unsubscribe():s}function ce(e){let t;return ut(e,s=>t=s)(),t}class ct extends Error{constructor(t,s){super(t),this.name="FelteSubmitError",this.response=s}}function tt(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(s[i[r]]=e[i[r]]);return s}function le(e,t){return He(e,s=>L(s)?le(s,t):Array.isArray(s)?s.length===0||s.every(i=>typeof i=="string")?t:s.map(i=>{const r=le(i,t);return tt(r,["key"])}):t)}function _e(e){return e?He(e,t=>L(t)?_e(t):Array.isArray(t)?t.length===0||t.every(s=>typeof s=="string")?t:t.map(s=>{if(!L(s))return s;const i=_e(s);return i.key||(i.key=Ze()),i}):t):{}}function ge(e){return e?He(e,t=>L(t)?ge(t):Array.isArray(t)?t.length===0||t.every(s=>typeof s=="string")?t:t.map(s=>{if(!L(s))return s;const i=ge(s);return tt(i,["key"])}):t):{}}function lt(){class e extends CustomEvent{constructor(r){super("feltesuccess",{detail:r})}}class t extends CustomEvent{constructor(r){super("felteerror",{detail:r,cancelable:!0})}setErrors(r){this.preventDefault(),this.errors=r}}class s extends Event{constructor(){super("feltesubmit",{cancelable:!0})}handleSubmit(r){this.onSubmit=r}handleError(r){this.onError=r}handleSuccess(r){this.onSuccess=r}}return{createErrorEvent:i=>new t(i),createSubmitEvent:()=>new s,createSuccessEvent:i=>new e(i)}}function dt(e){if(e)return async function(){let s=new FormData(e);const i=new URL(e.action),r=e.method.toLowerCase()==="get"?"get":i.searchParams.get("_method")||e.method;let c=e.enctype;e.querySelector('input[type="file"]')&&(c="multipart/form-data"),(r==="get"||c==="application/x-www-form-urlencoded")&&(s=new URLSearchParams(s));let u;r==="get"?(s.forEach((E,h)=>{i.searchParams.append(h,E)}),u={method:r,headers:{Accept:"application/json"}}):u={method:r,body:s,headers:Object.assign(Object.assign({},c!=="multipart/form-data"&&{"Content-Type":c}),{Accept:"application/json"})};const m=await window.fetch(i.toString(),u);if(m.ok)return m;throw new ct("An error occurred while submitting the form",m)}}function Ie(e,t,s,i){return qe(e,t,r=>(typeof r<"u"&&!Array.isArray(r)||(r||(r=[]),typeof i>"u"?r.push(s):r.splice(i,0,s)),r))}function ft(e,t,s,i){return qe(e,t,r=>(!r||!Array.isArray(r)||([r[s],r[i]]=[r[i],r[s]]),r))}function vt(e,t,s,i){return qe(e,t,r=>(!r||!Array.isArray(r)||r.splice(i,0,r.splice(s,1)[0]),r))}function Qe(e){return typeof e=="function"}function pe(e){return(s,i)=>{if(typeof s=="string"){const r=s;e(c=>{const u=Qe(i)?i(We(c,r)):i;return K(c,r,u)})}else e(r=>Qe(s)?s(r):s)}}function bt({stores:e,config:t,validateErrors:s,validateWarnings:i,_getCurrentExtenders:r}){var c;let u,m=_e((c=t.initialValues)!==null&&c!==void 0?c:{});const{data:E,touched:h,errors:p,warnings:A,isDirty:g,isSubmitting:D,interacted:j}=e,O=pe(E.update),N=pe(h.update),w=pe(p.update),G=pe(A.update);function B(a){O(v=>{const f=a(v);return u&&ke(u,f),f})}const _=(a,v,f)=>{pe(B)(a,v),typeof a=="string"&&f&&N(a,!0)};function se(a,v,f){const F=L(v)?le(v,!1):!1,W=L(F)?X(F,[]):[];v=L(v)?Object.assign(Object.assign({},v),{key:Ze()}):v,p.update(k=>Ie(k,a,W,f)),A.update(k=>Ie(k,a,W,f)),h.update(k=>Ie(k,a,F,f)),E.update(k=>{const z=Ie(k,a,v,f);return setTimeout(()=>u&&ke(u,z)),z})}function I(a){p.update(a),A.update(a),h.update(a),E.update(v=>{const f=a(v);return setTimeout(()=>u&&ke(u,f)),f})}function M(a){I(v=>Fe(v,a))}function Y(a,v,f){I(F=>ft(F,a,v,f))}function Z(a,v,f){I(F=>vt(F,a,v,f))}function de(a){const v=We(m,a),f=L(v)?le(v,!1):!1,F=L(f)?X(f,[]):[];E.update(W=>{const k=K(W,a,v);return u&&ke(u,k),k}),h.update(W=>K(W,a,f)),p.update(W=>K(W,a,F)),A.update(W=>K(W,a,F))}const b=pe(D.update),U=pe(g.update),V=pe(j.update);async function ie(){const a=ce(E);h.set(le(a,!0)),j.set(null);const v=await s(a);return await i(a),v}function ae(){_(ue(m)),N(a=>X(a,!1)),j.set(null),g.set(!1)}function T(a){return async function(f){var F,W,k,z,oe,Ee,he;const{createErrorEvent:De,createSubmitEvent:je,createSuccessEvent:Ae}=lt(),te=je();u?.dispatchEvent(te);const o=(W=(F=te.onError)!==null&&F!==void 0?F:a?.onError)!==null&&W!==void 0?W:t.onError,n=(z=(k=te.onSuccess)!==null&&k!==void 0?k:a?.onSuccess)!==null&&z!==void 0?z:t.onSuccess,l=(he=(Ee=(oe=te.onSubmit)!==null&&oe!==void 0?oe:a?.onSubmit)!==null&&Ee!==void 0?Ee:t.onSubmit)!==null&&he!==void 0?he:dt(u);if(!l||(f?.preventDefault(),te.defaultPrevented))return;D.set(!0),j.set(null);const d=ge(ce(E)),H=await s(d,a?.validate),ve=await i(d,a?.warn);if(ve&&A.set(Ve(X(d,[]),ve)),h.set(le(d,!0)),H&&(h.set(le(H,!0)),Re(H,x=>Array.isArray(x)?x.length>=1:!!x))){await new Promise(x=>setTimeout(x)),r().forEach(x=>{var J;return(J=x.onSubmitError)===null||J===void 0?void 0:J.call(x,{data:d,errors:H})}),D.set(!1);return}const re={event:f,setFields:_,setData:O,setTouched:N,setErrors:w,setWarnings:G,unsetField:M,addField:se,resetField:de,reset:ae,setInitialValues:ee.setInitialValues,moveField:Z,swapFields:Y,form:u,controls:u&&Array.from(u.elements).filter(ye),config:Object.assign(Object.assign({},t),a)};try{const P=await l(d,re);u?.dispatchEvent(Ae(Object.assign({response:P},re))),await n?.(P,re)}catch(P){const x=De(Object.assign({error:P},re));if(u?.dispatchEvent(x),!o&&!x.defaultPrevented)throw P;if(!o&&!x.errors)return;const J=x.errors||await o?.(P,re);J&&(h.set(le(J,!0)),p.set(J),await new Promise(ne=>setTimeout(ne)),r().forEach(ne=>{var be;return(be=ne.onSubmitError)===null||be===void 0?void 0:be.call(ne,{data:d,errors:ce(p)})}))}finally{D.set(!1)}}}const ee={setData:O,setFields:_,setTouched:N,setErrors:w,setWarnings:G,setIsSubmitting:b,setIsDirty:U,setInteracted:V,validate:ie,reset:ae,unsetField:M,resetField:de,addField:se,swapFields:Y,moveField:Z,createSubmitHandler:T,handleSubmit:T(),setInitialValues:a=>{m=_e(a)}};return{public:ee,private:{_setFormNode(a){u=a},_getInitialValues:()=>m}}}function mt({helpers:e,stores:t,config:s,extender:i,createSubmitHandler:r,handleSubmit:c,_setFormNode:u,_getInitialValues:m,_setCurrentExtenders:E,_getCurrentExtenders:h}){const{setFields:p,setTouched:A,reset:g,setInitialValues:D}=e,{addValidator:j,addTransformer:O,validate:N}=e,{data:w,errors:G,warnings:B,touched:_,isSubmitting:se,isDirty:I,interacted:M,isValid:Y,isValidating:Z}=t;function de(b){b.requestSubmit||(b.requestSubmit=c);function U(o){return function(n){return n({form:b,stage:o,controls:Array.from(b.elements).filter(ye),data:w,errors:G,warnings:B,touched:_,isValid:Y,isValidating:Z,isSubmitting:se,isDirty:I,interacted:M,config:s,addValidator:j,addTransformer:O,setFields:p,validate:N,reset:g,createSubmitHandler:r,handleSubmit:c})}}E(i.map(U("MOUNT"))),b.noValidate=!!s.validate;const{defaultData:V,defaultTouched:ie}=Ke(b);u(b),D(Ve(ue(V),m())),p(m()),_.set(ie);function ae(o){const n=$(o),l=Array.from(b.querySelectorAll(`[name="${o.name}"]`)).filter(d=>ye(d)?n===$(d):!1);if(l.length!==0)return l.length===1?w.update(d=>K(d,$(o),o.checked)):w.update(d=>K(d,$(o),l.filter(Ne).filter(H=>H.checked).map(H=>H.value)))}function T(o){const n=b.querySelectorAll(`[name="${o.name}"]`),l=Array.from(n).find(d=>Ne(d)&&d.checked);w.update(d=>K(d,$(o),l?.value))}function ee(o){var n;const l=Array.from((n=o.files)!==null&&n!==void 0?n:[]);w.update(d=>K(d,$(o),o.multiple?l:l[0]))}function fe(o){if(!o.multiple)w.update(n=>K(n,$(o),o.value));else{const n=Array.from(o.selectedOptions).map(l=>l.value);w.update(l=>K(l,$(o),n))}}function a(o){const n=o.target;if(!n||!ye(n)||xe(n)||Le(n)||["checkbox","radio","file"].includes(n.type)||!n.name)return;I.set(!0);const l=it(n);M.set(n.name),w.update(d=>K(d,$(n),l))}function v(o){const n=o.target;if(!(!n||!ye(n)||Le(n))&&n.name)if(A($(n),!0),M.set(n.name),(xe(n)||["checkbox","radio","file","hidden"].includes(n.type))&&I.set(!0),n.type==="hidden"&&w.update(l=>K(l,$(n),n.value)),xe(n))fe(n);else if(Ne(n))n.type==="checkbox"?ae(n):n.type==="radio"?T(n):n.type==="file"&&ee(n);else return}function f(o){const n=o.target;!n||!ye(n)||Le(n)||n.name&&(A($(n),!0),M.set(n.name))}function F(o){o.preventDefault(),g()}const W={childList:!0,subtree:!0};function k(o){let n=ce(w),l=ce(_),d=ce(G),H=ce(B);for(const ve of o.reverse()){if(ve.hasAttribute("data-felte-keep-on-remove")&&ve.dataset.felteKeepOnRemove!=="false")continue;const re=/.*(\[[0-9]+\]|\.[0-9]+)\.[^.]+$/;let P=$(ve);const x=ce(_);if(re.test(P)){const ne=P.split(".").slice(0,-1).join("."),be=We(x,ne);L(be)&&Object.keys(be).length<=1&&(P=ne)}n=Fe(n,P),l=Fe(l,P),d=Fe(d,P),H=Fe(H,P)}w.set(n),_.set(l),G.set(d),B.set(H)}const z=Pe(()=>{h().forEach(l=>{var d;return(d=l.destroy)===null||d===void 0?void 0:d.call(l)}),E(i.map(U("UPDATE")));const{defaultData:o,defaultTouched:n}=Ke(b);w.update(l=>Ge(l,o)),_.update(l=>Ge(l,n)),e.setFields(ce(w))},0);let oe=[];const Ee=Pe(()=>{h().forEach(o=>{var n;return(n=o.destroy)===null||n===void 0?void 0:n.call(o)}),E(i.map(U("UPDATE"))),k(oe),oe=[]},0);function he(o){Array.from(o.addedNodes).some(l=>Be(l)?ye(l)?!0:ze(l).length>0:!1)&&z()}function De(o){for(const n of o.removedNodes){if(!Be(n))continue;const l=ze(n);l.length!==0&&(oe.push(...l),Ee())}}function je(o){for(const n of o)n.type==="childList"&&(n.addedNodes.length>0&&he(n),n.removedNodes.length>0&&De(n))}const Ae=new MutationObserver(je);Ae.observe(b,W),b.addEventListener("input",a),b.addEventListener("change",v),b.addEventListener("focusout",f),b.addEventListener("submit",c),b.addEventListener("reset",F);const te=G.subscribe(o=>{for(const n of b.elements){if(!ye(n)||!n.name)continue;const l=We(o,$(n)),d=Array.isArray(l)?l.join(`
`):typeof l=="string"?l:void 0;d!==n.dataset.felteValidationMessage&&(d?(n.dataset.felteValidationMessage=d,n.setAttribute("aria-invalid","true")):(delete n.dataset.felteValidationMessage,n.removeAttribute("aria-invalid")))}});return{destroy(){Ae.disconnect(),b.removeEventListener("input",a),b.removeEventListener("change",v),b.removeEventListener("focusout",f),b.removeEventListener("submit",c),b.removeEventListener("reset",F),te(),h().forEach(o=>{var n;return(n=o.destroy)===null||n===void 0?void 0:n.call(o)})}}}return{form:de}}function pt(e){const t={aborted:!1,priority:e};return{signal:t,abort(){t.aborted=!0}}}function yt(e,t){if(L(e))return!t||L(t)&&Object.keys(t).length===0?X(e,null):void 0;if(Array.isArray(e)){if(e.some(L))return;const s=Array.isArray(t)?t:[];return e.map((i,r)=>{const c=s[r];return Array.isArray(c)&&c.length===0?null:i&&c||null})}return Array.isArray(t)&&t.length===0?null:Array.isArray(t)?e?t:null:e&&t?[t]:null}function Et(e,t){if(L(e))return!t||L(t)&&Object.keys(t).length===0?X(e,null):void 0;if(Array.isArray(e)){if(e.some(L))return;const s=Array.isArray(t)?t:[];return e.map((i,r)=>{const c=s[r];return Array.isArray(c)&&c.length===0?null:c||null})}return Array.isArray(t)&&t.length===0?null:Array.isArray(t)?t:t?[t]:null}function ht([e,t]){return et(t,e,yt)}function At([e,t]){return et(t,e,Et)}function wt(e){return function(s,i,r){const c=Array.isArray(s)?s:[s],u=new Array(c.length),m=e(r),E=m.set,h=m.subscribe;let p;function A(){p=c.map((D,j)=>D.subscribe(O=>{u[j]=O,E(i(u))}))}function g(){p?.forEach(D=>D())}return m.subscribe=function(j){const O=h(j);return()=>{O()}},[m,A,g]}}function St(e,t){var s,i,r,c,u,m,E,h,p;const A=wt(e),g=t.initialValues=t.initialValues?_e(Ue(ue(t.initialValues),t.transform)):{},D=le(ge(g),!1),j=e(D),O=e(0),[N,w,G]=A([j,O],([S,y])=>Re(S,C=>!!C)&&y>=1,!1);delete N.set,delete N.update;function B(S){let y;return async function(C,Q,q,we=!1){if(!q||!C)return;let me=Q&&Object.keys(Q).length>0?Q:X(C,[]);const Se=pt(we);if((!y?.signal.priority||we)&&(y?.abort(),y=Se),y.signal.priority&&!we)return;O.update(Oe=>Oe+1);const $e=at(C,q);return $e.forEach(async Oe=>{const nt=await Oe;Se.signal.aborted||(me=Te([me,nt]),S.set(me))}),await Promise.all($e),y=void 0,O.update(Oe=>Oe-1),me}}let _=X(D,[]);const se=e(g),I=X(D,[]),M=e(I),Y=e(ue(I)),[Z,de,b]=A([M,Y],Te,ue(I)),U=X(D,[]),V=e(U),ie=e(ue(U)),[ae,T,ee]=A([V,ie],Te,ue(U)),[fe,a,v]=A([Z,j],ht,ue(I)),[f,F,W]=A([ae,j],At,ue(U));let k=!1;const[z,oe,Ee]=A(Z,([S])=>{var y;return k?!Re(S,R=>Array.isArray(R)?R.length>=1:!!R):(k=!0,!t.validate&&!(!((y=t.debounced)===null||y===void 0)&&y.validate))},!t.validate&&!(!((s=t.debounced)===null||s===void 0)&&s.validate));delete z.set,delete z.update;const he=e(!1),De=e(!1),je=e(null),Ae=B(M),te=B(V),o=B(Y),n=B(ie),l=Pe(o,(u=(r=(i=t.debounced)===null||i===void 0?void 0:i.validateTimeout)!==null&&r!==void 0?r:(c=t.debounced)===null||c===void 0?void 0:c.timeout)!==null&&u!==void 0?u:300,{onInit:()=>{O.update(S=>S+1)},onEnd:()=>{O.update(S=>S-1)}}),d=Pe(n,(p=(E=(m=t.debounced)===null||m===void 0?void 0:m.warnTimeout)!==null&&E!==void 0?E:(h=t.debounced)===null||h===void 0?void 0:h.timeout)!==null&&p!==void 0?p:300);async function H(S,y){var R;const C=ge(S),Q=Ae(C,_,y??t.validate,!0);if(y)return Q;const q=o(C,_,(R=t.debounced)===null||R===void 0?void 0:R.validate,!0);return Te(await Promise.all([Q,q]))}async function ve(S,y){var R;const C=ge(S),Q=te(C,_,y??t.warn,!0);if(y)return Q;const q=n(C,_,(R=t.debounced)===null||R===void 0?void 0:R.warn,!0);return Te(await Promise.all([Q,q]))}let re=I,P=U;function x(){const S=se.subscribe(q=>{var we,me;const Se=ge(q);Ae(Se,_,t.validate),te(Se,_,t.warn),l(Se,_,(we=t.debounced)===null||we===void 0?void 0:we.validate),d(Se,_,(me=t.debounced)===null||me===void 0?void 0:me.warn)}),y=j.subscribe(q=>{_=X(q,[])}),R=Z.subscribe(q=>{re=q}),C=ae.subscribe(q=>{P=q});de(),oe(),T(),a(),F(),w();function Q(){S(),v(),b(),ee(),W(),Ee(),G(),y(),R(),C()}return Q}function J(S){M.set(S(re)),Y.set({})}function ne(S){V.set(S(P)),ie.set({})}function be(S){J(()=>S)}function rt(S){ne(()=>S)}return fe.set=be,fe.update=J,f.set=rt,f.update=ne,{data:se,errors:fe,warnings:f,touched:j,isValid:z,isSubmitting:he,isDirty:De,isValidating:N,interacted:je,validateErrors:H,validateWarnings:ve,cleanup:t.preventStoreStart?()=>{}:x(),start:x}}function gt(e,t){var s,i;(s=e.extend)!==null&&s!==void 0||(e.extend=[]),(i=e.debounced)!==null&&i!==void 0||(e.debounced={}),e.validate&&!Array.isArray(e.validate)&&(e.validate=[e.validate]),e.debounced.validate&&!Array.isArray(e.debounced.validate)&&(e.debounced.validate=[e.debounced.validate]),e.transform&&!Array.isArray(e.transform)&&(e.transform=[e.transform]),e.warn&&!Array.isArray(e.warn)&&(e.warn=[e.warn]),e.debounced.warn&&!Array.isArray(e.debounced.warn)&&(e.debounced.warn=[e.debounced.warn]);function r(T,{debounced:ee,level:fe}={debounced:!1,level:"error"}){var a;const v=fe==="error"?"validate":"warn";(a=e.debounced)!==null&&a!==void 0||(e.debounced={});const f=ee?e.debounced:e;f[v]?f[v]=[...f[v],T]:f[v]=[T]}function c(T){e.transform?e.transform=[...e.transform,T]:e.transform=[T]}const u=Array.isArray(e.extend)?e.extend:[e.extend];let m=[];const E=()=>m,h=T=>{m=T},{isSubmitting:p,isValidating:A,data:g,errors:D,warnings:j,touched:O,isValid:N,isDirty:w,cleanup:G,start:B,validateErrors:_,validateWarnings:se,interacted:I}=St(t.storeFactory,e),M=g.update,Y=g.set,Z=T=>M(ee=>_e(Ue(T(ee),e.transform))),de=T=>Y(_e(Ue(T,e.transform)));g.update=Z,g.set=de;const b=bt({extender:u,config:e,addValidator:r,addTransformer:c,validateErrors:_,validateWarnings:se,_getCurrentExtenders:E,stores:{data:g,errors:D,warnings:j,touched:O,isValid:N,isValidating:A,isSubmitting:p,isDirty:w,interacted:I}}),{createSubmitHandler:U,handleSubmit:V}=b.public;m=u.map(T=>T({stage:"SETUP",errors:D,warnings:j,touched:O,data:g,isDirty:w,isValid:N,isValidating:A,isSubmitting:p,interacted:I,config:e,addValidator:r,addTransformer:c,setFields:b.public.setFields,reset:b.public.reset,validate:b.public.validate,handleSubmit:V,createSubmitHandler:U}));const ie=Object.assign({config:e,stores:{data:g,touched:O,errors:D,warnings:j,isSubmitting:p,isValidating:A,isValid:N,isDirty:w,interacted:I},createSubmitHandler:U,handleSubmit:V,helpers:Object.assign(Object.assign({},b.public),{addTransformer:c,addValidator:r}),extender:u,_getCurrentExtenders:E,_setCurrentExtenders:h},b.private),{form:ae}=mt(ie);return Object.assign({data:g,errors:D,warnings:j,touched:O,isValid:N,isSubmitting:p,isValidating:A,isDirty:w,interacted:I,form:ae,cleanup:G,startStores:B},b.public)}function _t(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(s[i[r]]=e[i[r]]);return s}function Dt(e){const t={},s={};function i(r){if(!r)return e();if(!t[r.toString()]){const u=Ye(Je(Me(e),r));s[r.toString()]=u,t[r.toString()]=r}const[c]=s[r.toString()];return c()}return Xe(()=>{const r=e(),c=Object.keys(t);for(const u of c){const m=t[u],E=Je(r,m),[h,p]=s[m.toString()];ot(E,Me(h))||p(E)}}),i}function jt(e){return function(s){return st(i=>(Xe(()=>s(e())),i))}}const Ot=e=>{const[t,s]=Ye(e);function i(m){s(()=>m)}function r(m){s(m)}const c=Dt(t),u=jt(t);return c.subscribe=u,c.set=i,c.update=r,c};function kt(e){const t=gt(e??{},{storeFactory:Ot}),{form:s,cleanup:i,startStores:r,data:c,errors:u,warnings:m,touched:E}=t,h=_t(t,["form","cleanup","startStores","data","errors","warnings","touched"]);function p(A){const{destroy:g}=s(A);return Ce(g),{destroy:g}}return Ce(i),Object.assign(Object.assign({},h),{data:c,errors:u,warnings:m,touched:E,form:p})}export{kt as c};
